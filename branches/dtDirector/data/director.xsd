<?xml version="1.0" encoding="UTF-8"?>

<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
	targetNamespace="delta3dDirector"
	elementFormDefault="qualified"
	attributeFormDefault="unqualified">

  <xsd:annotation>
    <xsd:documentation xml:lang="en">
      Delta3D Director script file schema
    </xsd:documentation>
  </xsd:annotation>

  <xsd:element name="director" type="DirectorType"/>
  
  <xsd:complexType name="DirectorType">
    <xsd:sequence>
      <xsd:element name="header"      type="HeaderType"/>
      <xsd:element name="libraries"   type="LibrariesType"/>
	  <xsd:element name="graph"       type="GraphType"/>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="HeaderType">
    <xsd:sequence>
      <xsd:element name="createTimestamp"      type="xsd:dateTime"/>
      <xsd:element name="lastUpdateTimestamp"  type="xsd:dateTime"/>
      <xsd:element name="editorVersion"        type="xsd:string"/>
      <!-- map won't validate unless the version number is correct -->
      <xsd:element name="schemaVersion"        type="xsd:string" fixed="1.0"/>
      <xsd:element name="property" minOccurs="0" maxOccurs="unbounded" type="PropertyType"/>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="LibrariesType">
    <xsd:sequence>
      <xsd:element name="library" minOccurs="0" maxOccurs="unbounded">
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="name" type="xsd:string"/>
            <xsd:element name="version" type="xsd:string"/>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="GraphType">
    <xsd:sequence>
	  <xsd:element name="name"        type="xsd:string"/>
	  <xsd:element name="graph"       type="GraphType"/>
	  <xsd:element name="valuenodes"  type="NodeType"/>
	  <xsd:element name="eventnodes"  type="NodeType"/>
	  <xsd:element name="actionnodes" type="NodeType"/>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="NodeType">
    <xsd:sequence>
	  <xsd:element name="node" minOccurs="0" maxOccurs="unbounded">
        <xsd:complexType>
		  <xsd:sequence>
		    <xsd:element name="name"      type="xsd:string"/>
			<xsd:element name="category"  type="xsd:string"/>
			<xsd:element name="id"        type="xsd:string"/>
            <xsd:element name="property"   minOccurs="0" maxOccurs="unbounded" type="PropertyType"/>
			<xsd:element name="inputlink"  minOccurs="0" maxOccurs="unbounded" type="LinkType"/>
			<xsd:element name="outputlink" minOccurs="0" maxOccurs="unbounded" type="LinkType"/>
			<xsd:element name="valuelink"  minOccurs="0" maxOccurs="unbounded" type="LinkType"/>
		  </xsd:sequence>
		</xsd:complexType>
	  </xsd:element>
	</xsd:sequence>
  </xsd:complexType>
  
  <xsd:complexType name="LinkType">
    <xsd:sequence>
	  <xsd:element name="name"          type="xsd:string"/>
	  <xsd:element name="isout"         type="xsd:boolean"/>
	  <xsd:element name="allowmultiple" type="xsd:boolean"/>
	  <xsd:element name="typecheck"     type="xsd:boolean"/>
	  <xsd:element name="link" minOccurs="0" maxOccurs="unbounded">
	    <xsd:complexType>
	      <xsd:sequence>
		    <xsd:element name="name" type="xsd:string"/>
            <xsd:element name="id"   type="xsd:string"/>
		  </xsd:sequence>
	    </xsd:complexType>
	  </xsd:element>
	</xsd:sequence>
  </xsd:complexType>
  
  <xsd:complexType name="PropertyType">
    <xsd:sequence>
        <xsd:element name="name" type="xsd:string" />
        <xsd:choice>
          <xsd:element name="string" type="xsd:string" />
          <xsd:element name="enumerated" type="xsd:string"/>
          <xsd:element name="float" type="xsd:float"/>
          <xsd:element name="double" type="xsd:double"/>
          <xsd:element name="integer" type="xsd:int"/>
          <xsd:element name="long" type="xsd:long"/>
          <xsd:element name="vec4" type="Vec4Type" />
          <xsd:element name="vec3" type="Vec3Type" />
          <xsd:element name="vec2" type="Vec2Type"/>
          <xsd:element name="boolean" type="xsd:boolean"/>
          <xsd:element name="colorRGB" type="ColorRGBType"/>
          <xsd:element name="colorRGBA" type="ColorRGBAType"/>
          <xsd:sequence>
            <xsd:element name="resourceType" type="xsd:string" />
            <xsd:element name="resourceDisplayName" type="xsd:string" />
            <xsd:element name="resource" type="xsd:string" />
          </xsd:sequence>
          <xsd:element name="actorId" type="xsd:string" />
          <xsd:element name="group" type="GroupType"/>
          <xsd:element name="gameevent" type="xsd:string"/>
        </xsd:choice>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="GroupType">
    <xsd:sequence>
        <xsd:element name="parameter" minOccurs="0" maxOccurs="unbounded" type="PropertyType"/>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="Vec2Type">
    <xsd:all>
      <xsd:element name="value1" type="xsd:double" />
      <xsd:element name="value2" type="xsd:double" />
    </xsd:all>
  </xsd:complexType>

  <xsd:complexType name="Vec3Type">
    <xsd:all>
      <xsd:element name="value1" type="xsd:double" />
      <xsd:element name="value2" type="xsd:double" />
      <xsd:element name="value3" type="xsd:double" />
    </xsd:all>
  </xsd:complexType>

  <xsd:complexType name="Vec4Type">
    <xsd:all>
      <xsd:element name="value1" type="xsd:double" />
      <xsd:element name="value2" type="xsd:double" />
      <xsd:element name="value3" type="xsd:double" />
      <xsd:element name="value4" type="xsd:double" />
    </xsd:all>
  </xsd:complexType>

  <xsd:complexType name="ColorRGBType">
    <xsd:all>
      <xsd:element name="valueR" type="xsd:float" />
      <xsd:element name="valueG" type="xsd:float" />
      <xsd:element name="valueB" type="xsd:float" />
    </xsd:all>
  </xsd:complexType>

  <xsd:complexType name="ColorRGBAType">
    <xsd:all>
      <xsd:element name="valueR" type="xsd:float" />
      <xsd:element name="valueG" type="xsd:float" />
      <xsd:element name="valueB" type="xsd:float" />
      <xsd:element name="valueA" type="xsd:float" />
    </xsd:all>
  </xsd:complexType>

</xsd:schema>
